<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Gizmo PVP</title>
  <style>
    /* –í–†–ï–ú–ï–ù–ù–´–ï –°–¢–ò–õ–ò –ø—Ä—è–º–æ –≤ HTML */
    body {
      background: #2a2826;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    #pvp-container {
      max-width: 400px;
      margin: 0 auto;
      text-align: center;
    }
    #action-button {
      background: #7f5af0;
      color: white;
      border: none;
      padding: 12px 25px;
      font-size: 18px;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 20px;
    }
    #action-button:disabled {
      background: #555;
      cursor: not-allowed;
    }
  </style>
</head>
<body>

<div id="pvp-container">
  <h2>‚öîÔ∏è PVP –ê—Ä–µ–Ω–∞</h2>
  <div id="game-status">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ</div>
  <button id="action-button">–ù–∞—á–∞—Ç—å –±–æ–π (50üí∞)</button>
  <div id="result"></div>
</div>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"></script>

<script>
// 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
const firebaseConfig = {
  apiKey: "AIzaSyC6EklCDD25kU_nuXyeh5mj9F24KECyYpM",
  databaseURL: "https://gizmo-27843-default-rtdb.firebaseio.com"
};

const app = firebase.initializeApp(firebaseConfig);
const db = firebase.getDatabase(app);

// 2. –°–æ–∑–¥–∞—ë–º –∏–≥—Ä–æ–∫–∞
const currentPlayer = {
  id: 'player_' + Math.random().toString(36).slice(2, 9),
  name: '–ò–≥—Ä–æ–∫'
};

// 3. –ü–æ–ª—É—á–∞–µ–º –∫–Ω–æ–ø–∫—É
const actionButton = document.getElementById('action-button');
const gameStatus = document.getElementById('game-status');

// 4. –í–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
actionButton.addEventListener('click', async () => {
  actionButton.disabled = true;
  gameStatus.textContent = "–°–æ–∑–¥–∞—ë–º –∏–≥—Ä—É...";
  
  try {
    // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∏–≥—Ä—É –≤ Firebase
    const newGameRef = firebase.push(firebase.ref(db, 'games'));
    await firebase.set(newGameRef, {
      player1: currentPlayer,
      status: 'waiting',
      createdAt: Date.now()
    });
    
    gameStatus.textContent = "–û–∂–∏–¥–∞–µ–º —Å–æ–ø–µ—Ä–Ω–∏–∫–∞...";
    actionButton.textContent = "–û—Ç–º–µ–Ω–∏—Ç—å –∏–≥—Ä—É";
    
    // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–≥—Ä—ã
    firebase.onValue(newGameRef, (snapshot) => {
      const game = snapshot.val();
      if (!game) return;
      
      if (game.player2) {
        gameStatus.textContent = "–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!";
        startGame(game);
      }
    });
    
  } catch (error) {
    console.error("–û—à–∏–±–∫–∞:", error);
    actionButton.disabled = false;
  }
});

function startGame(game) {
  // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
  setTimeout(() => {
    const winner = Math.random() < 0.5 ? game.player1 : game.player2;
    document.getElementById('result').textContent = 
      winner.id === currentPlayer.id ? "–í—ã –ø–æ–±–µ–¥–∏–ª–∏!" : "–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏";
    actionButton.textContent = "–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞";
    actionButton.disabled = false;
  }, 3000);
}
</script>
</body>
</html>